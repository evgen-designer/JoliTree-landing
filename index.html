<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JoliTree - Decorate Your Virtual Tree</title>
    <link rel="icon" href="images/ball-red.png"> <!-- Using the red ball as favicon -->

    <!-- META TAGS -->
    <meta name="description" content="Create and decorate your perfect virtual Christmas tree.">
    <meta property="og:image" content="images/tree.png">
    
    <style>
        /* --- 1. CSS VARIABLES --- */
        :root {
            --color-bg: #cbd5e1;
            --color-surface: rgba(255, 255, 255, 0.85);
            --color-border: #e2e8f0;
            --color-text: #1e293b;
            --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body, html {
            height: 100%; width: 100%;
            font-family: var(--font-sans);
            color: var(--color-text);
            overflow: hidden;
            background-color: var(--color-bg);
        }

        /* --- 2. LAYOUT --- */
        .app-container { display: flex; flex-direction: column; height: 100vh; }

        /* THE CANVAS (Your Tree) */
        .canvas-area {
            flex: 1;
            position: relative;
            background: radial-gradient(circle at center, #e2e8f0 0%, #94a3b8 100%);
            overflow: hidden;
            /* Touch Action for Dragging support later */
            touch-action: none; 
        }

        /* The Tree Image Container */
        .tree-container {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 90%; /* Adjust based on tree height */
            max-width: 600px;
            pointer-events: none; /* Let clicks pass through to ornaments */
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .tree-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: bottom center;
            filter: drop-shadow(0 20px 30px rgba(0,0,0,0.2));
        }

        /* Ornaments on the Tree */
        .placed-ornament {
            position: absolute;
            width: 60px; /* Default size on tree */
            height: 60px;
            cursor: grab;
            transition: transform 0.1s;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.15));
            user-select: none;
        }
        .placed-ornament:active { cursor: grabbing; transform: scale(1.1); }

        /* --- 3. SIDEBAR PALETTE --- */
        .palette {
            background-color: var(--color-surface);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 0 solid var(--color-border);
            display: flex;
            z-index: 100;
        }

        .palette-scroll {
            display: flex;
            gap: 0.5rem;
            padding: 0.75rem;
            overflow: auto;
        }

        /* BUTTONS */
        .btn-ornament {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            cursor: pointer;
            padding: 0.5rem;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .btn-ornament:hover { background: #f8fafc; transform: translateY(-2px); }
        .btn-ornament:active { transform: translateY(0); }
        
        .ornament-thumb {
            width: 48px;
            height: 48px;
            object-fit: contain;
        }

        .ornament-label { display: none; font-weight: 500; margin-left: 10px; }

        /* Footer Controls */
        .palette-footer { padding: 0.75rem; display: flex; align-items: center; }
        .btn-clear {
            width: 100%; padding: 0.6rem;
            border-radius: 99px; border: 1px solid #1e293b;
            background: transparent; font-weight: 600; cursor: pointer;
        }
        .btn-clear:hover { background: #1e293b; color: #fff; }

        /* --- RESPONSIVE --- */
        /* Mobile (Default) */
        .palette { flex-direction: row; border-top-width: 1px; width: 100%; }
        .palette-scroll { flex: 1; flex-direction: row; }
        .palette-footer { border-left: 1px solid var(--color-border); }

        /* Desktop */
        @media (min-width: 768px) {
            .app-container { flex-direction: row; }
            .canvas-area { order: 2; }
            .palette {
                order: 1; flex-direction: column;
                width: 280px; height: 100%;
                border-right-width: 1px; border-top-width: 0;
            }
            .palette-header { display: block; padding: 1.5rem; text-align: center; border-bottom: 1px solid var(--color-border); }
            .palette-scroll { flex-direction: column; overflow-y: auto; }
            .btn-ornament { width: 100%; justify-content: flex-start; padding: 0.75rem; }
            .ornament-label { display: block; }
            .palette-footer { border-top: 1px solid var(--color-border); border-left: none; }
        }
        .palette-header { display: none; }
        @media (min-width: 768px) { .palette-header { display: block; } }
    </style>
</head>
<body>

    <main class="app-container">
        
        <!-- 1. CANVAS AREA -->
        <section class="canvas-area" id="canvasArea">
            <!-- The Tree Image -->
            <div class="tree-container">
                <img src="images/tree.png" alt="Christmas Tree" class="tree-image">
            </div>
            <!-- Ornaments will be injected here by JS -->
        </section>

        <!-- 2. SIDEBAR -->
        <aside class="palette">
            <header class="palette-header">
                <h2>JoliTree</h2>
            </header>

            <nav class="palette-scroll">
                
                <!-- STAR -->
                <button class="btn-ornament" onclick="addOrnament('star.png')" aria-label="Add Star">
                    <img src="images/star.png" class="ornament-thumb" alt="">
                    <span class="ornament-label">Golden Star</span>
                </button>

                <!-- RED BALL -->
                <button class="btn-ornament" onclick="addOrnament('ball-red.png')" aria-label="Add Red Ball">
                    <img src="images/ball-red.png" class="ornament-thumb" alt="">
                    <span class="ornament-label">Red Ornament</span>
                </button>

                <!-- BLUE BALL -->
                <button class="btn-ornament" onclick="addOrnament('ball-blue.png')" aria-label="Add Blue Ball">
                    <img src="images/ball-blue.png" class="ornament-thumb" alt="">
                    <span class="ornament-label">Blue Ornament</span>
                </button>

                <!-- CANDY CANE -->
                <button class="btn-ornament" onclick="addOrnament('candy-cane.png')" aria-label="Add Candy Cane">
                    <img src="images/candy-cane.png" class="ornament-thumb" alt="">
                    <span class="ornament-label">Candy Cane</span>
                </button>

                <!-- GIFT -->
                <button class="btn-ornament" onclick="addOrnament('gift.png')" aria-label="Add Gift">
                    <img src="images/gift.png" class="ornament-thumb" alt="">
                    <span class="ornament-label">Gift Box</span>
                </button>

            </nav>

            <footer class="palette-footer">
                <button class="btn-clear" onclick="clearAll()">Clear All</button>
            </footer>
        </aside>
    </main>

    <script>
        const canvas = document.getElementById('canvasArea');

        // Function to Add Ornament
        function addOrnament(filename) {
            const img = document.createElement('img');
            img.src = `images/${filename}`;
            img.classList.add('placed-ornament');
            
            // Random position near center to start
            // (Simulating placing it on the tree)
            const randomX = 40 + Math.random() * 20; // 40-60% (Centerish)
            const randomY = 30 + Math.random() * 40; // 30-70% (Middle height)
            
            img.style.left = `${randomX}%`;
            img.style.top = `${randomY}%`;
            
            // Add simple drag functionality
            makeDraggable(img);
            
            canvas.appendChild(img);
        }

        function clearAll() {
            if(confirm('Remove all decorations?')) {
                const ornaments = document.querySelectorAll('.placed-ornament');
                ornaments.forEach(o => o.remove());
            }
        }

        // Basic Drag and Drop Logic (Desktop + Mobile)
        function makeDraggable(el) {
            let isDragging = false;
            
            // Mouse Events
            el.addEventListener('mousedown', startDrag);
            window.addEventListener('mousemove', drag);
            window.addEventListener('mouseup', endDrag);
            
            // Touch Events (Mobile)
            el.addEventListener('touchstart', startDrag, {passive: false});
            window.addEventListener('touchmove', drag, {passive: false});
            window.addEventListener('touchend', endDrag);

            let startX, startY, initialLeft, initialTop;

            function startDrag(e) {
                isDragging = true;
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                
                startX = clientX;
                startY = clientY;
                
                // Get current percentage positions
                const rect = el.getBoundingClientRect();
                const parentRect = canvas.getBoundingClientRect();
                
                initialLeft = el.offsetLeft;
                initialTop = el.offsetTop;
                
                e.preventDefault(); // Prevent scrolling on touch
            }

            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();

                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;

                const dx = clientX - startX;
                const dy = clientY - startY;

                el.style.left = `${initialLeft + dx}px`;
                el.style.top = `${initialTop + dy}px`;
            }

            function endDrag() {
                isDragging = false;
            }
        }
    </script>
</body>
</html>
